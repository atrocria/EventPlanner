# guestlistUI.py
import customtkinter as ctk
from tkinter import messagebox

class GuestListUI(ctk.CTkFrame):
    def __init__(self, parent, controller, back_target, title="Guest Manager"):
        super().__init__(parent)
        self.controller = controller
        self.back_target = back_target

        header = ctk.CTkLabel(self, text=title, font=("Arial", 20, "bold"))
        header.pack(pady=10)

        self.name_entry = ctk.CTkEntry(self, width=260, corner_radius=8)
        self.name_entry.pack(pady=5)

        self.rsvp_var = ctk.StringVar(value="Yes")
        rsvp_dropdown = ctk.CTkComboBox(self, values=["Yes", "No"], variable=self.rsvp_var, width=260)
        rsvp_dropdown.pack(pady=5)

        ctk.CTkButton(self, text="Add Guest", command=self.add_guest).pack(pady=5)
        ctk.CTkButton(self, text="View Guests", command=self.view_guests).pack(pady=5)
        ctk.CTkButton(self, text="Remove Guest", command=self.remove_guest).pack(pady=5)
        ctk.CTkButton(self, text="Back", command=lambda: back_target.tkraise()).pack(pady=5)

    def add_guest(self):
        result = self.controller.add_guest(self.name_entry.get().strip(), self.rsvp_var.get())
        if result["status"] == "error":
            messagebox.showerror("Error", result["message"])
        else:
            messagebox.showinfo("Success", result["message"])

    def view_guests(self):
        result = self.controller.view_guests()
        if result["status"] == "empty":
            messagebox.showinfo("Guest List", result["message"])
        else:
            messagebox.showinfo("Guest List", result["message"])

    def remove_guest(self):
        name = self.name_entry.get().strip()
        result = self.controller.remove_guest(name)
        if result["status"] == "error":
            messagebox.showerror("Error", result["message"])
        else:
            messagebox.showinfo("Success", result["message"])